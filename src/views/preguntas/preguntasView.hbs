<script src="/static/preguntas.js"></script>
<div class="text-center my-5">
    <h1>Formulario de Preguntas</h1>
</div>
{{> buttons
       message="Crear pregunta"
        type = "primary"
        tag = "a"
        href = "http://localhost:3000/preguntas/add"
     }}
    <br><br><br>

    <form action = "/preguntas" method="get">
    <div class="input-group mb-3">
      <input
        type="text"
        class="form-control"
        name = "buscar"
        placeholder="Recipient's username"
        aria-label="Recipient's username"
        aria-describedby="button-addon2"
      />
      {{> buttons
        type="success"
        message="Buscar"
        nativeType="submit"}}
    </div>
    </form>
    {{!-- Tabla de contenidos   --}}

<h5>Gestión de preguntas</h5>
<table id="grid" class="table table-striped table-bordered dt-responsive nowrap">
            
              <div>
                <thead>
                <tr>
                    <th width="75%">Pregunta</th>
                    <th>Acciones</th>
                </tr>
            </thead>
              </div>
          
            {{#each pregunta}}
                <tr>
                    <td>{{title}}</td>
                    <td>
                      <div class="d-flex justify-content-around">
                        <a class="btn btn-success" href="/preguntas/{{_id}}" >Ver</a>
                   
                        <a class="btn btn-warning"  href="/preguntas/editar/{{_id}}" >Editar</a>

                        <form action="/preguntas/delete/{{_id}}?_method=post" method="POST">
                          <div class="form-group">
                            <button class="btn btn-danger" onclick="borrarPregunta(event, '{{ _id }}')">Eliminar</button>
                            <input id="form-{{_id}}" type="submit" hidden>
                          </div>
                        </form>
                      </div>
                   </th> </td>
                </tr>
                {{else}}
                 <div class="card mx-auto">
                    <div class="lead  d-flex flex-column align-items-center">
                      <p>No hay preguntas ingresadas aún</p>
                      <a href="/preguntas/add" class="btn btn-success btn-block">Crear una</a>
                    </div>
                 </div>

                {{/each}}
</table>     

  </div>
</div>


<script>
    function borrarPregunta(e, id) {
        e.preventDefault();
        swal({
            title: "¿Esta seguro que quiere eliminar este elemento?",
            text: "Al darle click en OK va a eliminar permanentemente la pregunta",
            buttons: true,
            })
            .then((willDelete) => {
            if (willDelete) {
                let form = document.getElementById("form-" + id);
                form.click();
            } 
        });
    }
</script>